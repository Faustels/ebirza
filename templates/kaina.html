<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css"    href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css"></link>
    <link rel="stylesheet" href="/static/css/style.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <title>Title</title>
</head>
<body class="d-flex flex-column min-vh-100">
{% include "inserts/common/assistant.html" %}
{% include "inserts/common/navigation.html" %}

    <div id="priceChart" style="width: 900px; height: 500px"></div>


{% include "inserts/common/footer.html" %}

</body>
{% include "inserts/common/scripts.html" %}
<script>
    function getData() {
        fetch("/kaina/getPrice", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(0)
        })
            .then(res => res.text())
            .then(response => {
                let data = JSON.parse(response);
                draw(data);
            });

    }
    function draw(data) {
        google.charts.load('current', {'packages': ['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var newDataTable = new google.visualization.DataTable();
            newDataTable.addColumn("number", "X");
            newDataTable.addColumn("number", "Buy");
            newDataTable.addColumn("number", "Sell");
            newDataTable.addRows(data);

            var options = {
                title: 'Kaina',
                legend: {position: 'right'},
                curveType: "function",
                orientation: 'vertical',
                vAxis: {
                    title: 'Kaina'
                },
                hAxis: {
                    title: 'Kiekis (mWh)'
                },
                interpolateNulls: true,
            };

            var chart = new google.visualization.LineChart($("#priceChart")[0]);

            chart.draw(newDataTable, options);
        }
    }
    getData();
</script>
</html>